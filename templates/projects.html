{% extends "_base.html" %}
{% set active = "/projects" %}
{% set page_title = "Projects" %}

{% block body %}
<div class="space-y-4">
  {% if projects %}
    {% for p in projects %}
      <details class="card">
        <summary class="cursor-pointer flex justify-between items-center">
          <span>{{ p.description|truncate(80, True, '‚Ä¶') }}</span>
          <form action="/delete_project" method="post" class="inline" onclick="event.stopPropagation();">
            <input type="hidden" name="ts" value="{{ p.ts.isoformat() }}">
            <button type="submit" title="Delete" onclick="return confirm('Delete project?')">üóëÔ∏è</button>
          </form>
        </summary>
        <div class="mt-2 text-sm text-[var(--color-text-light)]">{{ p.description }}</div>
        <div class="overflow-auto">{{ p.table_html | safe }}</div>
      </details>
    {% endfor %}
  {% else %}
    <p>No past projects found.</p>
  {% endif %}

  <div class="flex justify-between items-center pt-2 text-sm">
    {% if prev_page %}
      <a href="/projects?page={{ prev_page }}" class="text-blue-600 hover:underline">&laquo; Prev</a>
    {% else %}
      <span></span>
    {% endif %}
    <span>Page {{ page }} of {{ pages }}</span>
    {% if next_page %}
      <a href="/projects?page={{ next_page }}" class="text-blue-600 hover:underline">Next &raquo;</a>
    {% else %}
      <span></span>
    {% endif %}
  </div>
</div>
{% endblock %}
