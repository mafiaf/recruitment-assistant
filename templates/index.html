{% extends "_base.html" %}
{% set active = "/" %}
{% set page_title = "Home" %}

{% block body %}
<div class="px-6 pt-6 flex flex-col items-center gap-8">

  <!-- drop-zone -->
  <form id="resume-form"
        class="w-full max-w-xl border-4 border-dashed border-gray-300
               rounded-2xl flex flex-col items-center justify-center py-16 bg-white">
    <input id="resume-file" type="file" name="file" accept=".pdf,.docx" class="hidden">
    <p class="text-lg text-gray-500 mb-4">
      Drag & drop a résumé PDF/DOCX here<br>or click to browse
    </p>
    <button id="select-btn" type="button"
            class="px-4 py-2 rounded bg-blue-600 text-white">Browse files</button>
  </form>

  <!-- recent uploads -->
  <section class="w-full max-w-5xl">
    <h2 class="text-lg font-medium mb-2">Recent uploads</h2>
    <table class="w-full text-sm border rounded-xl overflow-hidden shadow">
      <thead>
        <tr class="bg-gray-100 text-left">
          <th class="px-4 py-2">Name</th>
          <th class="px-2 py-2">Added</th>
          <th class="px-2 py-2">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for r in resumes %}
        <tr class="odd:bg-white even:bg-gray-50">
          <td class="px-4 py-2">{{ r.name }}</td>
          <td class="px-2 py-2">{{ r.added|default('—') }}</td>
          <td class="px-2 py-2 space-x-3">
            <a href="/resumes#{{ r.id }}" class="text-blue-600 hover:underline">edit</a>
            <form action="/delete_resume" method="post" class="inline">
              <input type="hidden" name="id" value="{{ r.id }}">
              <button class="text-red-600 hover:underline"
                      onclick="return confirm('Delete?')">delete</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

</div>
{% endblock %}

{% block extra_js %}
<script>
document.getElementById('select-btn').onclick =
  () => document.getElementById('resume-file').click();

const f = document.getElementById('resume-file');
f.onchange = () => f.form.submit();   // auto-submit after choosing a file
</script>
{% endblock %}
